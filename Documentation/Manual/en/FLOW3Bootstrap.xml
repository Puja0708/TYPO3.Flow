<?xml version="1.0" encoding="UTF-8"?>
<section version="5.0" xmlns="http://docbook.org/ns/docbook"
         xmlns:ns52="http://www.w3.org/1998/Math/MathML"
         xmlns:ns5="http://www.w3.org/1999/xlink"
         xmlns:ns4="http://www.w3.org/2000/svg"
         xmlns:ns3="http://www.w3.org/1999/xhtml"
         xmlns:ns="http://docbook.org/ns/docbook">
  <title>FLOW3 Bootstrap</title>

  <para>This section is work in progress and only contains some bullet points
  for the later documenation.</para>

  <section>
    <title>Application Context</title>

    <para>The FLOW3 Framework can be started in different application
    contexts. An application context basically is a set of configuration which
    has been defined for a certain context. By default, FLOW3 provides
    configuration for the <literal>Production</literal>,
    <literal>Development</literal>, <literal>Testing</literal>, and
    <literal>Staging</literal> context. More contexts may be defined by just
    adding configuration for it accordingly (refer to the Configuration
    section to learn more about configuration).</para>

    <para>The FLOW3 boot strap is always instantiated in a certain application
    context. By default (when calling the <filename>index.php</filename> file)
    the context is <literal>Production</literal>. In the standard distribution
    a file <filename>index_dev.php</filename> exists which runs FLOW3 in the
    <literal>Development</literal> context.</para>
  </section>

  <section>
    <title>Boot Sequence</title>

    <para><itemizedlist>
        <listitem>
          <para>Construction</para>

          <para><itemizedlist>
              <listitem>
                <para>Stage 1: instantiate FLOW3 with application
                context</para>
              </listitem>

              <listitem>
                <para>Stage 2: Check environment for the FLOW3 package</para>
              </listitem>
            </itemizedlist></para>
        </listitem>

        <listitem>
          <para>Initialization</para>

          <itemizedlist>
            <listitem>
              <para>Stage 3: Load FLOW3 configuration</para>

              <para>from Packages/FLOW3/Configuration/FLOW3.php,
              /Configuration/FLOW3.php and the context directory</para>
            </listitem>

            <listitem>
              <para>Stage 4: Package configuration</para>

              <para>Scan available packages</para>

              <para>Load the package configuration from
              /Configuration/Packages.php, then the context configuration from
              /Configuration/Production/Packages.php.</para>

              <para>Load additional package configuration from
              [PackageDir]/Configuration/Packages.php</para>

              <para>Assert package interdependencies</para>

              <para>Assert package environment dependencies</para>
            </listitem>

            <listitem>
              <para>Stage 5: Component Configuration</para>

              <para>Register all package classes as components</para>

              <para>Load global component configuration from
              /Configuration/Components.php</para>

              <para>Load additional component configuration from packages
              (/Configuration/Components.php)</para>

              <para>POST PROCESSING (defined in
              Configuration/FLOW3.php):</para>

              <para>-&gt; Build aspect containers, proxy classes and modify
              the component configurations if necessary</para>
            </listitem>

            <listitem>
              <para>Stage 6: Settings</para>

              <para>Load settings from global Settings.ini and context
              Settings.php</para>

              <para>Load settings from package's Settings.php</para>

              <para>Load settings from additional registered sources</para>

              <para>-&gt; Settings are defined per-package and can be
              retrieved through the package object (getSettings())</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para>Execution</para>

          <para>Resolve a request handler and invoke it</para>
        </listitem>
      </itemizedlist></para>
  </section>
</section>